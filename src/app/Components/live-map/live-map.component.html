<div class="map-section">
  <div class="map-header">
    <h2 class="section-title">Live Map</h2>
    <div class="map-controls">
      <!-- Date Range Filter -->
      <div class="date-filters">
        <input
          type="date"
          [(ngModel)]="dateRange.from"
          (change)="onDateRangeChange()"
          class="form-control form-control-sm"
        />
        <span class="mx-2">to</span>
        <input
          type="date"
          [(ngModel)]="dateRange.to"
          (change)="onDateRangeChange()"
          class="form-control form-control-sm"
        />
      </div>

      <!-- Filter Buttons -->
      <div class="filter-group">
        <span class="filter-label">Filter by</span>
        <button
          class="btn btn-sm"
          [class.btn-primary]="filterType === 'all'"
          [class.btn-outline]="filterType !== 'all'"
          (click)="onFilterChange('all')"
        >
          All Data
        </button>
        <button
          class="btn btn-sm"
          [class.btn-primary]="filterType === 'hotspots'"
          [class.btn-outline]="filterType !== 'hotspots'"
          (click)="onFilterChange('hotspots')"
        >
          Hotspots
        </button>
        <button
          class="btn btn-sm"
          [class.btn-primary]="filterType === 'tags'"
          [class.btn-outline]="filterType !== 'tags'"
          (click)="onFilterChange('tags')"
        >
          Tag Data
        </button>
      </div>

      <!-- Refresh Button -->
      <button
        class="btn btn-outline btn-sm"
        (click)="onRefresh()"
        [disabled]="isLoading"
      >
        <i class="bi bi-arrow-clockwise"></i>
        Refresh
      </button>
    </div>
  </div>

  <!-- Map Container -->
  <div class="map-wrapper">
    <div id="map" class="map-container"></div>

    <!-- Loading Overlay -->
    <div class="map-loading" *ngIf="isLoading">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p>Loading map data...</p>
    </div>
  </div>

  <!-- Legend -->
  <div class="map-legend">
    <h6>Legend</h6>
    <div class="legend-items">
      <div class="legend-item">
        <span class="legend-marker" style="background: #2ecc71"></span>
        <span>Low Activity (1-4)</span>
      </div>
      <div class="legend-item">
        <span class="legend-marker" style="background: #f39c12"></span>
        <span>Medium Activity (5-9)</span>
      </div>
      <div class="legend-item">
        <span class="legend-marker" style="background: #e74c3c"></span>
        <span>High Activity (10+)</span>
      </div>
      <div class="legend-item">
        <span class="legend-marker hotspot-legend"></span>
        <span>Hotspot Zone</span>
      </div>
    </div>
  </div>
</div>
